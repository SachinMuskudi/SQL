/* TCL OPERATIONS */


USE AMAZON

CREATE TABLE INDIAN_PLAYERS (PLAYER_ID INT,PLAYER_NAME CHAR(10),PLAYER_SCORE TINYINT)

SELECT *FROM INDIAN_PLAYERS

INSERT INTO INDIAN_PLAYERS VALUES (1,'DHONI',76)

BEGIN TRANSACTION
ROLLBACK 

TRUNCATE TABLE INDIAN_PLAYERS 

/* USE SQL + TCL OPERATIONS */

BEGIN TRANSACTION
INSERT INTO INDIAN_PLAYERS VALUES (1,'DHONI',76)
INSERT INTO INDIAN_PLAYERS VALUES (2,'ROHITH',90)
COMMIT


BEGIN TRANSACTION
UPDATE INDIAN_PLAYERS SET PLAYER_SCORE=86 WHERE PLAYER_SCORE=76
COMMIT 

BEGIN TRANSACTION 
UPDATE INDIAN_PLAYERS SET PLAYER_NAME='VIRAT' WHERE PLAYER_NAME='DHONI'

BEGIN TRANSACTION
ROLLBACK 


/* SAVE POINT */

SELECT *FROM INDIAN_PLAYERS

/* RANKING IN SQL */

/* THERE ARE 2 TYPES OF RANKINGS IN SQL */
/* 1 . ROW WISE RANKING */
/* 2.  GROUPWISE RANKING */
/* IN RANKING WE HAVE 3 FUNCTIONS */
/* 1. ROW_NUMBER()   2. RANK ()  3. DENSE_RANK() */



/* ROW WISE RANKING */

CREATE TABLE EMPLOYEE (EMPID INT,EMPNAME VARCHAR(10),EMPSALARY MONEY)

DROP TABLE EMPLOYEE
/* ROW WISE RANKING */

INSERT INTO EMPLOYEE VALUES (1,'JOHN',1200)
INSERT INTO EMPLOYEE VALUES (2,'PETER',1500)
INSERT INTO EMPLOYEE VALUES (3,'MICHEAL',1800)
INSERT INTO EMPLOYEE VALUES (4,'BRAD',200)
INSERT INTO EMPLOYEE VALUES (5,'COAL',1500)
INSERT INTO EMPLOYEE VALUES (6,'KIRAN',850)
INSERT INTO EMPLOYEE VALUES (7,'KUMAR',670)
INSERT INTO EMPLOYEE VALUES (8,'GAUTHAM',990)
INSERT INTO EMPLOYEE VALUES (9,'STEVE',1800)
INSERT INTO EMPLOYEE VALUES (10,'SMITH',2200)

SELECT *FROM EMPLOYEE

SELECT EMPID,EMPNAME,EMPSALARY,ROW_NUMBER() OVER (ORDER BY EMPSALARY ASC) AS KAMAL FROM EMPLOYEE

SELECT EMPID,EMPNAME,EMPSALARY,RANK() OVER (ORDER BY EMPSALARY ASC) AS KAMAL FROM EMPLOYEE

SELECT EMPID,EMPNAME,EMPSALARY,DENSE_RANK() OVER (ORDER BY EMPSALARY ASC) AS KAMAL FROM EMPLOYEE

/* GROUP WISE RANKING */

TRUNCATE TABLE EMPLOYEE

/* GROUP BY RANKING */
INSERT INTO EMPLOYEE VALUES (1,'JOHN',1200)
INSERT INTO EMPLOYEE VALUES (1,'JAMES',1400)
INSERT INTO EMPLOYEE VALUES (1,'JACKSON',1200)
INSERT INTO EMPLOYEE VALUES (1,'PRIYA',1300)
INSERT INTO EMPLOYEE VALUES (1,'KAVITHA',2000)

INSERT INTO EMPLOYEE VALUES (2,'MIKE',100)
INSERT INTO EMPLOYEE VALUES (2,'MICHEAL',200)
INSERT INTO EMPLOYEE VALUES (2,'KIRAN',400)
INSERT INTO EMPLOYEE VALUES (2,'KUMAR',200)
INSERT INTO EMPLOYEE VALUES (2,'KRISHNA',300)

INSERT INTO EMPLOYEE VALUES (3,'PRASANA',3200)
INSERT INTO EMPLOYEE VALUES (3,'PAVAN',4800)

SELECT EMPID,EMPNAME,EMPSALARY,DENSE_RANK() OVER (PARTITION BY EMPID ORDER BY EMPSALARY ASC) AS RANK FROM EMPLOYEE